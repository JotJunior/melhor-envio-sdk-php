<?php

require "./vendor/autoload.php";

use MelhorEnvio\Enums\Environment;
use MelhorEnvio\MelhorEnvioSdkPhp\Event;
use MelhorEnvio\MelhorEnvioSdkPhp\OAuth2;
use MelhorEnvio\MelhorEnvioSdkPhp\Shipment;
use MelhorEnvio\Resources\Shipment\Product;

$accessToken = "eeyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiIsImp0aSI6IjBhYmU4OGE2ZmU5NzIxMzU2YTc1MDJjOGRmYWQ2NDlmYWVjNWY4ZjU2NjNmNDkxNzczMjQwMzYyYjE0MjhhODU1ZjI4ODhiY2MzYWJiMzFlIn0.eyJhdWQiOiIyNjM1IiwianRpIjoiMGFiZTg4YTZmZTk3MjEzNTZhNzUwMmM4ZGZhZDY0OWZhZWM1ZjhmNTY2M2Y0OTE3NzMyNDAzNjJiMTQyOGE4NTVmMjg4OGJjYzNhYmIzMWUiLCJpYXQiOjE2NDYzOTgzOTIsIm5iZiI6MTY0NjM5ODM5MiwiZXhwIjoxNjQ4OTkwMzkyLCJzdWIiOiJjNDNiMzBjNS0zYWViLTRhYjYtYTQ3OS0yYjlmZWJiYzgwOTgiLCJzY29wZXMiOlsic2hpcHBpbmctY2FsY3VsYXRlIl19.ktTYTdeloI03iRdbmeBSrLbxtl3BzgQLDtzAkwmHUNrNbPXZP7M1EjW89j4ONn8FLmvTVhGsQ6o4TR7pV-KfigY_AbswxLg4cCsdUW_ctu7aMwTGBk5Wojxi9N4vTxGaj1osSYTJZhjK1RYRdB5zH4eBPXWClZZB97P3wvyMSYWeJnqcPQWNhSdUhyofHj5_jalsxbX2nx7vbG3W8l7sYtuUXTEUxt73XD4XkyGicTYOWco1E2qQbrmwsjmhW2lQwpieJchxtHFx_Rc-TE43K5aoluLmUd7SDwlLHpV1AUZakaSnoPwueE_X_Fc3STiLXr0Vhiur5q0-TcT3jOn162dK8OzcEtQ40KptcrI9wAUHva28TXPfCvf29Esq1R7PKO5X48YbKEaCtAyFiEfwd61Nrl78436IbFMczS9IcslbSWrJefpnW6PXld8Ga81hJhSRjwi3Vkrrfi2Se7HkERcOEfAgMFJMmFQM2eXYOya6fvWYaCmqz8B5450_GIwF1_qQeQSoyvLmi1GIeI_NKL2IetIBpasuVZ1WWSi11unavHuUAdCl2XrAg7qIt0b3dJzVw9BqOMURhBjLTIDmI6dKc6wmLiUQE3QaNvOFLx5haECnhHL9dcJcpAnhjUE1VuxBSZL7KVyRn58qG0Fo8PzsrlLV7EwyhuVOqWh9_RU.eyJhdWQiOiIyNjM1IiwianRpIjoiNTIzYWE4YzIxNjRiZDViZWE4YTMxZjk1YmNlMWRhNGRmY2Y2OWU4YWI4Y2VjNmU3MDc1MmQzMzU5MjEwZGFhZWVlM2Y2YWJkNTQyMDdkYTMiLCJpYXQiOjE2NDYwNzI1NzIsIm5iZiI6MTY0NjA3MjU3MiwiZXhwIjoxNjQ4NjY0NTcyLCJzdWIiOiJjNDNiMzBjNS0zYWViLTRhYjYtYTQ3OS0yYjlmZWJiYzgwOTgiLCJzY29wZXMiOltdfQ.HuRlBQy33xdTd-MxiPvpY4DidpYgTP1jX7z2z0llUetk4QNjSO_xAouq3JSG4sYJHxx1kDaZquRkpbmX4a_o2IPf-ZkgmZ0aKp0z0mpxS-ay7bB4s9dDo7nCLmtrjd71qljNPyuYPn-HVO2ispY-8p-15QhWKf1tuFWkEck5kWcNvBnSj1H-4wLyU9QJ8sDZoTxxpdxfo0cE4Vv0EUB8GCnVc1YrmrtGAKhUxM1T_PITinF2ZI_6I2eiyk2p2Z0x5CPeqUVe87DGIn9OGCVFphZfQCcQRaGEPO6amTtSRl3a8sHzBWn5bZ3xq1vYZQbHrLhuMNmaUJqa-bUWw2lkRyOCQv0PQ2jJlRP-aOMWzPG3oXTq5vjJApIvDgIYyjAy-HbA8vrJM_9jWIJCam4frqa5OWYkLhHCqIsbg9txuqDfVGVn3Ah6DTJyXAfPzjuobMBzEeV5NjWkdIPoV7TKqyTOie3dpyQOBFqNFxpWNoOfFTuEDdRH3aIzUQxS1ENgIEWP7SeALXc3SsT7wczEM6oMicg7EGOIpruERbnYvJ8-XojePHLMVIBYTog8AnGnwxQ5Q0UDpSfGNxxh9JaY19AJqQYgzA9_z-DBR0dlFMpF7_GaAtdbXGcQTFyTps1_C2x6vqrFbKHnNmrEuRy22Lx3J0-9Jxuo5MtY-DqkW6M.eyJhdWQiOiIyNjM1IiwianRpIjoiMzI3OTVlNGRiMmFlOGY4MWViNjU2OWUxMWY3YzIzMjVkM2RmMTI3ZjAzMjJkMDk3Zjc0MjNlMzgwYjcwZmJkYzIwMjgzYmU4MTcwYzBkMWIiLCJpYXQiOjE2NDU3OTQzOTIsIm5iZiI6MTY0NTc5NDM5MiwiZXhwIjoxNjQ4Mzg2MzkyLCJzdWIiOiJjNDNiMzBjNS0zYWViLTRhYjYtYTQ3OS0yYjlmZWJiYzgwOTgiLCJzY29wZXMiOlsic2hpcHBpbmctY2FsY3VsYXRlIl19.aimxkPqdnKrt4Qx3W8Oqf3pWtEVP2gCxheoAlxnqlsJDdk2Qtud3mdEy3bjBIMNEWOaA30iBMdUTY2RCO23fis9gcrpGLuol2VDbh21ENSK9a7-30cJEayaQGiKki1GHmjwGTuGxOYq-7jnShnTBR1qWP3eOY4fTTg_IV8Cg7ET9VuQ-x0xdwWRxbP65uWqM2l-BEZYIz4om8ctN44DDVEaXPt2KolnSq7atcpn9dgqtJEeFkiiFXMKnIxnm-DP9-lr0WYr1VkIuO_nDK937CFV6J0G82Q-203VXTzEshH1ChWLkke4JquecM1JY2kNjQBH5OsUjfrvyfzJ7h_qJtfrG-3Q_qt8NNWbROi1c_xbIZV-cOcKTLdAXu_7nY8HUPbjKlatKI4RP-5pY9u0KErhzLnsN8V3uAeTmkSop0jYXg87dcKs0RN8Dzv_lv9BRLYt0fKu-bTdDB6X5vGt4pdJbqHZGIKkKuzQirkNZSrboRx3mB7eBkrKBs5Sw0ancjsFD0OfQ4YOCaBL4qD9gLzBoucZmmVRs6y6NXKm03dWufv42g4PW8aeksIoAtdo0nHoVFK9Gwefx6CSxDBNELFNAsFe83NvlP9DBEX8oxzwY9uYsW0TtVFJIV5XilW0pLY37RdPmJBzpxl3N7f1wQV1gl8jM8hfuA3_Za9KhTL4";
$refreshToken = "def502004ba6b4380d55cf516644c49fc5924ee91f00dcbe21a85bc64fb9ba2393ec2551d8e9202fb0b0c030826dadad7e4b4d2573597e4a483db7b96286c5c651c143a08019e2d4011ca9c3a1d31cf06c06f36d8f5a5a65c08c432a9ed2b2b146073476923f5a081c126a19a7f1dc72a0cf6a9dad496403e8a6944bad36ba5ed5e206993f5c7b96e4b38214ea6de6ea713684fb5feb1689d0ba3e5b504839ddd9b77400b197c3ebf5ce2c870046787dd4822ed58d82594e903448db95c27ff0fe0903a4d3566ff583863c5ffc4e0b4f56955d445bf90f67f98c4277a001e72a94eedff496c1be2d32b47ef5737a80e75ab45b38add3262e5a9f0a5c238e574b84dfd880a7cf69c17ea70c82d13ffed89da6cea8cc830f7c591414134a5d706e11c79822e044b77b8af67e0ceba8054321d405f30017f007d3b799e4e798e159983c6b3e631453d1599743674a8c4b9eabdb018e31b81314a9b20f47135e247532b7cfdba01903a3cd98c22cb1305746b8e49229e51fae973426f9a503051b1bde51c7a7cd60a7c163268d8410c8e51818dd31de4e409f41c549f4f739";

$appData = [
    'client_id' => 2635,
    'client_secret' => 'O9WeVIi7zzCNhqveldS7oEm0YSF5lU6gCilnSkRj',
    'redirect_uri' => 'https://bridge-woocommerce.test/callback'
];

Event::listen('refresh', function ($token, $refreshToken) {
    // Put here trading rule to save accessToken e refreshToken.
});

$shipment = new Shipment(
    $accessToken,
    $refreshToken,
    Environment::SANDBOX,
    $appData['client_id'],
    $appData['client_secret'],
    $appData['redirect_uri']
);

$calculator = $shipment->calculator();

$calculator->postalCode('01010010', '20271130');

$calculator->setOwnHand();
$calculator->setReceipt(false);
$calculator->setCollect(false);

$calculator->addProducts(
    new Product(uniqid(), 40, 30, 50, 10.00, 100.0, 1),
    new Product(uniqid(), 5, 1, 10, 0.1, 50.0, 1)
);

$quotations = $calculator->calculate();

var_dump($quotations);
